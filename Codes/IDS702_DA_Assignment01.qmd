---
title: "IDS702_DA_Assignment01"
author: "Divya"
format: html
editor: visual
jupyter: ir
editor_options: 
  chunk_output_type: console
---

```{r}
library(dplyr)
```

```{r}
initial_data <- read.csv('https://github.com/DivyaSharma0795/IDS702_Data_Analysis_Assignment_1/raw/main/Resources/listings.csv')
```

```{r}
glimpse(initial_data)
```

```{r}
airbnb <- initial_data
```

```{r}
# Adding Distance to Downtown as a variable from lat long data
library(geosphere)
airbnb$dist_to_dt <- apply(airbnb[,c("longitude","latitude")],1,function(x) distm(
  c(-82.55481168521978,35.59701329976918),
  x,fun=distHaversine))*0.00062137
```

```{r}
library(tidyverse)
# Cleaning the Price variable - removing $ signs and commas
airbnb$cleaned_price <- as.numeric(gsub(',','',str_sub(airbnb$price,2)))
```

```{r}
# Cleaning the bathrooms column
library(readr)
airbnb$bathrooms_text <- tolower(airbnb$bathrooms_text)
airbnb$bathrooms_text <- ifelse(grepl("half", airbnb$bathrooms_text, fixed = TRUE), "0.5",airbnb$bathrooms_text)
airbnb$bathrooms_numeric <- parse_number(airbnb$bathrooms_text)
```

```{r}

model_v1 <- lm(cleaned_price ~ 
                 room_type + 
                 bedrooms + 
                 dist_to_dt + 
                 bathrooms_numeric + 
                 accommodates + 
                 beds + 
                 minimum_nights + 
                 maximum_nights + 
                 has_availability + 
                 number_of_reviews + 
                 review_scores_rating + 
                 reviews_per_month + 
                 review_scores_location + 
                 review_scores_value + 
                 review_scores_communication + 
                 review_scores_checkin + 
                 review_scores_cleanliness + 
                 review_scores_accuracy
               ,data = airbnb)
summary(model_v1)
```

```{r}
glimpse(airbnb)
```

```{r}
library(tidyr)
airbnb$host_is_superhost_1 <- replace(airbnb$host_is_superhost,airbnb$host_is_superhost == "",'f')
unique(airbnb$host_is_superhost_1)
unique(airbnb$host_is_superhost)
```
